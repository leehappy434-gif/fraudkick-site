(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,14775,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.i(51718);var s=e.i(18357),i=e.i(76009);e.i(36180);var r=e.i(98925);let u=(0,a.createContext)(void 0);function o({children:e}){let[o,l]=(0,a.useState)(null),[n,d]=(0,a.useState)(null),[c,h]=(0,a.useState)(!0);(0,a.useEffect)(()=>(0,s.onAuthStateChanged)(i.auth,async e=>{if(l(e),e)try{let t=(0,r.doc)(i.db,"users",e.uid),a=await (0,r.getDoc)(t);if(a.exists())d(a.data());else{let a={uid:e.uid,email:e.email||"",displayName:e.displayName||"",createdAt:new Date().toISOString(),userType:"consumer",totalReports:0,totalVotes:0};await (0,r.setDoc)(t,a),d(a)}}catch(e){console.error("Error fetching user data:",e)}else d(null);h(!1)}),[]);let p=async(e,t,a)=>{let u=await (0,s.createUserWithEmailAndPassword)(i.auth,e,t),o=(0,r.doc)(i.db,"users",u.user.uid),l={uid:u.user.uid,email:e,displayName:a,createdAt:new Date().toISOString(),userType:"consumer",totalReports:0,totalVotes:0};await (0,r.setDoc)(o,l),d(l)},m=async(e,t)=>{await (0,s.signInWithEmailAndPassword)(i.auth,e,t)},w=async()=>{let e=new s.GoogleAuthProvider,t=await (0,s.signInWithPopup)(i.auth,e),a=(0,r.doc)(i.db,"users",t.user.uid);if(!(await (0,r.getDoc)(a)).exists()){let e={uid:t.user.uid,email:t.user.email||"",displayName:t.user.displayName||"",createdAt:new Date().toISOString(),userType:"consumer",totalReports:0,totalVotes:0};await (0,r.setDoc)(a,e),d(e)}},y=async()=>{await (0,s.signOut)(i.auth),d(null)},g=async e=>{if(!o)return;let t=(0,r.doc)(i.db,"users",o.uid);await (0,r.setDoc)(t,{...n,...e},{merge:!0}),d({...n,...e})};return(0,t.jsx)(u.Provider,{value:{user:o,userData:n,loading:c,signup:p,login:m,loginWithGoogle:w,logout:y,updateUserProfile:g},children:e})}function l({children:e}){return(0,t.jsx)(o,{children:e})}e.s(["AppProviders",()=>l],14775)}]);